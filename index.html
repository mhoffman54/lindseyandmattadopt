<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TPGFWX0WCB"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-TPGFWX0WCB');
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta property="og:title" content="Lindsey & Matt | Our Hearts are Open">
    <meta property="og:description" content="We are Lindsey and Matt, and we are hoping to grow our family through adoption. We'd be honored if you took a moment to hear our story.">
    <meta property="og:image" content="https://mhoffman54.github.io/lindseyandmattadopt/hawaii-us.jpg">
    <meta property="og:url" content="https://mhoffman54.github.io/lindseyandmattadopt/">
    <meta property="og:type" content="website">
    
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:none;stroke:%23E76F51;stroke-linecap:round;stroke-linejoin:round;stroke-width:35px;%7D.cls-2%7Bfill:%23E76F51;font-family:sans-serif;font-weight:bold;font-size:90px;text-anchor:middle;%7D%3C/style%3E%3C/defs%3E%3Cpath class='cls-1' d='M256 50 L460 430 H52 Z'/%3E%3Cpath class='cls-1' d='M256 160 C140 160 140 290 256 400 C372 290 372 160 256 160 Z'/%3E%3Ctext x='50%25' y='68%25' class='cls-2'%3EL+M%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' style='background-color:white;'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:none;stroke:%23E76F51;stroke-linecap:round;stroke-linejoin:round;stroke-width:35px;%7D.cls-2%7Bfill:%23E76F51;font-family:sans-serif;font-weight:bold;font-size:90px;text-anchor:middle;%7D%3C/style%3E%3C/defs%3E%3Crect width='100%25' height='100%25' fill='white'/%3E%3Cpath class='cls-1' d='M256 50 L460 430 H52 Z'/%3E%3Cpath class='cls-1' d='M256 160 C140 160 140 290 256 400 C372 290 372 160 256 160 Z'/%3E%3Ctext x='50%25' y='68%25' class='cls-2'%3EL+M%3C/text%3E%3C/svg%3E">

    <title>Lindsey & Matt | Our Hearts are Open</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&family=Lora:ital,wght@1,500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #FFF5E4 0%, #FFE3D8 100%);
            --card-white: rgba(255, 255, 255, 0.92);
            --terracotta: #E76F51;
            --sage-green: #2A9D8F;
            --deep-text: #264653;
            --accent-gold: #E9C46A;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            margin: 0; 
            font-family: 'Quicksand', sans-serif; 
            background: var(--bg-gradient); 
            background-attachment: fixed;
            color: var(--deep-text);
            line-height: 1.6;
            min-height: 100vh;
        }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.98) translateY(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        header {
            padding: 70px 20px 60px;
            text-align: center;
            background: white;
            border-bottom-left-radius: 50% 20px;
            border-bottom-right-radius: 50% 20px;
            position: relative;
            box-shadow: 0 10px 40px rgba(231, 111, 81, 0.1);
        }

        h1 { 
            font-family: 'Lora', serif; 
            font-style: italic; 
            font-size: clamp(2.2rem, 5vw, 3.8rem); 
            line-height: 1.2;
            margin-bottom: 15px;
            color: var(--terracotta);
            animation: fadeInScale 1s ease-out;
        }

        header p {
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
            color: #555;
        }

        nav { 
            display: flex; 
            justify-content: center;
            gap: 12px; 
            padding: 15px 20px; 
            position: sticky;
            top: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(8px);
            z-index: 100;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }
        nav::-webkit-scrollbar { display: none; }

        .nav-link {
            text-decoration: none;
            color: var(--deep-text);
            font-weight: 700;
            padding: 10px 22px;
            border-radius: 30px;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 2px solid transparent;
            font-size: 0.9rem;
            flex-shrink: 0;
            background: rgba(233, 196, 106, 0.15);
        }

        .nav-link.active {
            background: var(--terracotta);
            color: white;
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(231, 111, 81, 0.4);
        }

        @media (max-width: 768px) {
            nav { justify-content: flex-start; padding: 15px; }
            header { padding-top: 50px; }
            .nav-link { padding: 8px 18px; }
        }

        .page-content { 
            display: none; 
            padding: 40px 20px; 
            max-width: 900px; 
            margin: 0 auto; 
            animation: fadeInScale 0.5s ease-out;
        }

        .page-content.active { display: block; }

        .feature-card {
            background: var(--card-white);
            border-radius: 30px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(231, 111, 81, 0.08);
            margin-bottom: 30px;
            border: 2px solid white;
        }

        h2 { color: var(--sage-green); margin-top: 0; }
        h3 { color: var(--terracotta); }

        /* --- FEATURE IMAGES --- */
        .feature-img-wrapper {
            overflow: hidden;
            border-radius: 10px;
            margin-bottom: 25px;
            border: 8px solid #fff;
            transform: scale(0.95) rotate(-3deg);
            opacity: 0.9;
            box-shadow: 5px 10px 20px rgba(0,0,0,0.15);
            transition: all 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        
        .feature-card:hover .feature-img-wrapper,
        .feature-img-wrapper.mobile-pop { 
            transform: scale(1.05) rotate(0deg) translateY(-8px); 
            opacity: 1;
            box-shadow: 0 30px 60px rgba(50, 50, 93, 0.4), 0 10px 25px rgba(0, 0, 0, 0.2);
            z-index: 5;
        }

        .feature-img { width: 100%; display: block; }

        .dog-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 25px; 
        }

        .gallery-grid {
            column-count: 3;
            column-gap: 30px;
            padding: 10px;
        }
        @media (max-width: 900px) { .gallery-grid { column-count: 2; } }
        @media (max-width: 600px) { .gallery-grid { column-count: 1; } }

        /* --- GALLERY ITEMS --- */
        .gallery-item {
            break-inside: avoid;
            margin-bottom: 40px;
            border-radius: 6px;
            overflow: hidden;
            background: #eee;
            position: relative;
            border: 8px solid white;
            cursor: pointer;
            opacity: 0.8; 
            filter: grayscale(20%);
            box-shadow: 2px 5px 15px rgba(0,0,0,0.1);
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .gallery-item:nth-child(2n) { transform: scale(0.9) rotate(3.5deg); }
        .gallery-item:nth-child(3n) { transform: scale(0.9) rotate(-3.5deg) translateX(-5px); }
        .gallery-item:nth-child(5n) { transform: scale(0.9) rotate(2deg) translateY(-5px); }
        .gallery-item:nth-child(7n) { transform: scale(0.9) rotate(-4.5deg); }

        .gallery-item:hover,
        .gallery-item.mobile-pop {
            transform: scale(1.05) rotate(0deg) translateY(-10px) !important;
            opacity: 1;
            filter: grayscale(0%);
            box-shadow: 0 25px 50px rgba(0,0,0,0.3), 0 10px 20px rgba(0,0,0,0.22);
            z-index: 100;
        }
        
        .gallery-item img { width: 100%; display: block; }

        /* --- REELS TAB STYLES --- */
        #reels-container {
            height: 75vh;
            width: 100%;
            max-width: 500px; 
            margin: 0 auto;
            background: #000;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            overflow-y: scroll;
            scroll-snap-type: y mandatory;
            scrollbar-width: none; 
        }
        #reels-container::-webkit-scrollbar { display: none; }

        .reel-item {
            height: 100%;
            width: 100%;
            scroll-snap-align: start; 
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #111;
        }

        .reel-item video {
            width: 100%;
            height: 100%;
            object-fit: cover; 
        }

        /* --- FROSTED LIGHTBOX --- */
        #lightbox {
            display: none;
            position: fixed;
            z-index: 2000;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.05); 
            backdrop-filter: blur(15px) brightness(0.6); 
            -webkit-backdrop-filter: blur(15px) brightness(0.6);
            justify-content: center;
            align-items: center;
        }
        
        #lightbox img {
            width: 100%;
            height: auto;
            max-width: 1000px;
            max-height: 85vh;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 20px 80px rgba(0,0,0,0.6);
            border: 2px solid rgba(255,255,255,0.8);
            transition: transform 0.2s ease;
        }

        .nav-zone {
            position: absolute; top: 0; bottom: 0; width: 15%;
            z-index: 2010;
        }
        #zone-left { left: 0; }
        #zone-right { right: 0; }

        #lightbox-close {
            position: absolute; top: 20px; right: 20px;
            font-size: 2.5rem; color: rgba(255,255,255,0.8); padding: 10px;
            z-index: 2020; cursor: pointer; text-shadow: 0 2px 5px rgba(0,0,0,0.5);
        }

        /* --- ANIMATED SWIPE HINT --- */
        @keyframes swipeAnimation {
            0% { transform: translateX(0) rotate(10deg); opacity: 0; }
            10% { transform: translateX(0) rotate(10deg); opacity: 1; }
            50% { transform: translateX(-40px) rotate(0deg); opacity: 1; }
            80% { transform: translateX(0) rotate(10deg); opacity: 1; }
            100% { transform: translateX(0) rotate(10deg); opacity: 0; }
        }

        #swipe-hint {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2050;
            pointer-events: none;
            display: none;
            text-align: center;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        
        #swipe-hint svg {
            width: 60px;
            height: 60px;
            filter: drop-shadow(0 2px 5px rgba(0,0,0,0.5));
            animation: swipeAnimation 2s ease-in-out infinite;
        }
        
        #swipe-hint p {
            margin: 5px 0 0;
            font-weight: 700;
            font-size: 1.1rem;
            letter-spacing: 1px;
            opacity: 0.9;
            animation: fadeInScale 2s infinite;
        }

        /* --- FLOATING CONTACT BUTTON --- */
        .floating-contact {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--terracotta);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 5px 20px rgba(231, 111, 81, 0.4);
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .floating-contact:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(231, 111, 81, 0.5);
        }

        .contact-info-popup {
            display: none;
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            z-index: 999;
            min-width: 250px;
            border: 1px solid rgba(0,0,0,0.05);
            animation: fadeInScale 0.3s ease-out;
        }

        .contact-info-popup h3 {
            margin: 0 0 10px 0;
            color: var(--terracotta);
            font-size: 1.2rem;
        }

        .contact-info-popup p {
            margin: 5px 0;
            font-size: 0.95rem;
            color: var(--deep-text);
        }

        .contact-info-popup a {
            color: var(--sage-green);
            text-decoration: none;
            font-weight: 600;
        }

        /* --- SAVE TO CONTACTS BUTTON (FIXED WHITE TEXT) --- */
        .save-contact-btn {
            display: block;
            margin-top: 15px;
            background: var(--sage-green);
            color: #ffffff !important; /* Force White */
            padding: 12px 15px;
            border-radius: 20px;
            text-align: center;
            text-decoration: none;
            font-weight: 700;
            font-size: 0.95rem;
            transition: all 0.2s;
            box-shadow: 0 4px 10px rgba(42, 157, 143, 0.3);
        }
        
        .save-contact-btn:hover {
            background: #238b7e;
            transform: scale(1.02);
        }

    </style>
</head>
<body>

<header>
    <h1>You're not alone in this.</h1>
    <p>We can't imagine the weight of the decision you're making, but we're honored you're taking a moment to see who we are.</p>
</header>

<nav id="stickyNav">
    <a class="nav-link active" onclick="gtag('event', 'view_story'); showPage('story')">Our Story</a>
    <a class="nav-link" onclick="gtag('event', 'view_lindsey'); showPage('lindsey')">Meet Lindsey</a>
    <a class="nav-link" onclick="gtag('event', 'view_matt'); showPage('matt')">Meet Matt</a>
    <a class="nav-link" onclick="gtag('event', 'view_dogs'); showPage('dogs')">The Dogs</a>
    <a class="nav-link" onclick="gtag('event', 'view_home'); showPage('home')">Our Home</a>
    <a class="nav-link" onclick="gtag('event', 'view_reels'); showPage('reels')">Reels</a>
    <a class="nav-link" onclick="gtag('event', 'view_gallery'); showPage('gallery')">Gallery</a>
    <a class="nav-link" onclick="gtag('event', 'view_contact'); showPage('contact')">Contact Us</a>
</nav>

<div id="story" class="page-content active">
    <div class="feature-card">
        <div class="feature-img-wrapper">
            <img src="hawaii-us.jpg" class="feature-img" alt="Lindsey and Matt">
        </div>
        <h2 style="font-family: 'Lora', serif; font-size: 1.8rem;">Adventure & Love</h2>
        <p>We’ve spent years building a life in the Minneapolis suburbs — a place where we've put down deep roots. Whether it’s dog sledding in Ely, an afternoon at the dog park or spending time with our nieces and nephews, we love creating memories with those we love.</p>
        <p>Our home is full of laughter, adventure, and the kind of quiet, steady love that we can't wait to share with a child.</p>
    </div>
</div>

<div id="lindsey" class="page-content">
    <div class="feature-card">
        <h2 style="font-family: 'Lora', serif;">Meet Lindsey</h2>
        <p>I’m the one who handles the snacks, the birthdays, and the bedtime stories. I've always dreamed of being a mom—of being the safe place a child comes to when they're scared and the loudest voice cheering them on no matter what they're doing.</p>
    </div>
</div>

<div id="matt" class="page-content">
    <div class="feature-card">
        <h2 style="font-family: 'Lora', serif;">Meet Matt</h2>
        <p>Whether I'm managing fleet vehicles at work or fixing up something in the garage, I love to build things that last. I’m ready to be a dad who teaches a kid how to use a hammer, how to cheer with their whole heart, and how to know they are always, always loved.</p>
    </div>
</div>

<div id="dogs" class="page-content">
    <div class="dog-grid">
        <div class="feature-card">
            <div class="feature-img-wrapper">
                <img src="wyatt-birthday.jpg" class="feature-img" alt="Wyatt">
            </div>
            <h3>Wyatt</h3>
            <p>Our patient, loyal boy who has a huge heart and can't wait to meet his new best buddy.</p>
        </div>
        <div class="feature-card">
            <div class="feature-img-wrapper">
                <img src="harley-nap.jpg" class="feature-img" alt="Harley">
            </div>
            <h3>Harley</h3>
            <p>The soul of the house. She’s at her happiest when she's either got a lap to snuggle up on, or a ball in her mouth and a friend to throw it for her.</p>
        </div>
    </div>
</div>

<div id="home" class="page-content">
    <div class="feature-card">
        <h2 style="font-family: 'Lora', serif;">Our Home</h2>
        <p>Our home in the Minneapolis area is more than just walls. It's where we laugh, relax, and grow.</p>
    </div>
</div>

<div id="reels" class="page-content">
    <div style="text-align: center; margin-bottom: 20px;">
        <h2 style="font-family: 'Lora', serif;">Video Moments</h2>
        <p>Swipe up to see more.</p>
    </div>
    
    <div id="reels-container">
        <p id="reels-loading" style="color:white; text-align:center; padding-top:50%;">Loading Videos...</p>
    </div>
</div>

<div id="gallery" class="page-content">
    <div style="text-align: center; margin-bottom: 30px;">
        <h2 style="font-family: 'Lora', serif;">Our Life in Pictures</h2>
        <p>Big moments, quiet Sundays, and everything in between.</p>
    </div>

    <div id="magic-gallery" class="gallery-grid">
        <p id="loading-text" style="text-align:center; width:100%; opacity:0.6;">Loading photos...</p>
    </div>
</div>

<div id="contact" class="page-content">
    <div class="feature-card" style="text-align:center;">
        <h2 style="font-family: 'Lora', serif;">Get in Touch</h2>
        <p>We would love to hear from you. Feel free to call, text, or email us anytime.</p>
        
        <div style="margin: 30px 0; font-size: 1.1rem;">
            <p><strong>Call or Text:</strong> <br><a href="tel:6123898469" onclick="gtag('event', 'click_phone');" style="color:var(--terracotta); text-decoration:none;">(612) 389-8469</a></p>
            <p><strong>Email:</strong> <br><a href="mailto:LindseyAndMattMN@gmail.com" onclick="gtag('event', 'click_email');" style="color:var(--terracotta); text-decoration:none;">LindseyAndMattMN@gmail.com</a></p>
        </div>

        <a href="#" onclick="gtag('event', 'save_contact'); downloadVCard(); return false;" class="save-contact-btn" style="display:inline-block; padding: 15px 30px; font-size:1rem;">Save to Contacts</a>
    </div>
</div>

<div class="floating-contact" onclick="gtag('event', 'open_contact_popup'); toggleContactPopup()">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="white" style="margin-right:5px;">
        <path d="M20.01 15.38c-1.23 0-2.42-.2-3.53-.56a.977.977 0 00-1.01.24l-2.2 2.2a15.057 15.057 0 01-6.59-6.59l2.2-2.21a.96.96 0 00.25-1.01A11.36 11.36 0 018.59 3.98a1 1 0 00-1-1H4.02a1 1 0 00-1 1c0 9.39 7.61 17 17 17a1 1 0 001-1v-3.5a1 1 0 00-1-1.1z"/>
    </svg>
    <span>Contact Us</span>
</div>

<div id="contact-popup" class="contact-info-popup">
    <h3>Get in Touch</h3>
    <p><strong>Call or Text:</strong> <br><a href="tel:6123898469" onclick="gtag('event', 'click_phone');">(612) 389-8469</a></p>
    <p><strong>Email:</strong> <br><a href="mailto:LindseyAndMattMN@gmail.com" onclick="gtag('event', 'click_email');">LindseyAndMattMN@gmail.com</a></p>
    <a href="#" onclick="gtag('event', 'save_contact'); downloadVCard(); return false;" class="save-contact-btn">Save to Contacts</a>
</div>

<div id="lightbox">
    <div id="lightbox-close" onclick="closeLightbox()">&times;</div>
    
    <div id="zone-left" class="nav-zone" onclick="changeImage(-1)"></div>
    <div id="zone-right" class="nav-zone" onclick="changeImage(1)"></div>
    
    <img id="lightbox-img" src="">
    
    <div id="swipe-hint">
        <svg viewBox="0 0 24 24" fill="white">
            <path d="M9 11.24V7.5C9 6.12 10.12 5 11.5 5S14 6.12 14 7.5v3.74c1.21-.81 2-2.18 2-3.74C16 5.01 13.99 3 11.5 3S7 5.01 7 7.5c0 1.56.79 2.93 2 3.74zm9.84 4.63l-4.54-2.26c-.17-.07-.35-.11-.54-.11H13v-6c0-.83-.67-1.5-1.5-1.5S10 6.67 10 7.5v10.74l-3.43-.72c-.08-.01-.15-.03-.24-.03-.31 0-.59.13-.79.33l-.79.8 4.94 4.94c.27.27.65.44 1.06.44h6.79c.75 0 1.33-.55 1.44-1.28l.75-5.27c.01-.07.02-.14.02-.2 0-.62-.38-1.16-.91-1.38z"/>
        </svg>
        <p>SWIPE</p>
    </div>
</div>

<script>
    let galleryImages = []; 
    let currentImageIndex = 0; 
    let observer; 
    let reelsObserver; // Separate observer for video playback
    let hintShown = false; 
    
    let touchStartX = 0;
    let touchEndX = 0;

    function showPage(pageId) {
        document.querySelectorAll('.page-content').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        
        document.getElementById(pageId).classList.add('active');
        
        const links = document.querySelectorAll('.nav-link');
        for (let link of links) {
            if (link.getAttribute('onclick').includes(pageId)) {
                link.classList.add('active');
                link.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
            }
        }
        window.scrollTo({ top: 0, behavior: 'smooth' });
        setTimeout(initScrollObserver, 100);
        
        // If Reels page is shown, trigger reel loading/observing
        if (pageId === 'reels') {
            loadReels();
        } else {
            // If leaving reels, pause all videos
            document.querySelectorAll('video').forEach(vid => vid.pause());
        }
    }

    // Toggle Floating Contact Popup
    function toggleContactPopup() {
        const popup = document.getElementById('contact-popup');
        if (popup.style.display === 'block') {
            popup.style.display = 'none';
        } else {
            popup.style.display = 'block';
        }
    }

    // Generate and Download vCard
    function downloadVCard() {
        const vCardData = `BEGIN:VCARD
VERSION:3.0
FN:Lindsey & Matt
TEL;TYPE=CELL:(612) 389-8469
EMAIL:LindseyAndMattMN@gmail.com
END:VCARD`;

        const blob = new Blob([vCardData], { type: 'text/vcard' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'Lindsey_and_Matt.vcf';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }

    function openLightboxByIndex(index) {
        currentImageIndex = index;
        updateLightboxImage();
        document.getElementById('lightbox').style.display = 'flex';
        document.body.style.overflow = 'hidden';
        
        if (!hintShown) {
            const hint = document.getElementById('swipe-hint');
            hint.style.display = 'block';
            setTimeout(() => { hint.style.display = 'none'; }, 2800);
            hintShown = true;
        }
    }

    function changeImage(direction) {
        currentImageIndex += direction;
        if (currentImageIndex >= galleryImages.length) currentImageIndex = 0;
        if (currentImageIndex < 0) currentImageIndex = galleryImages.length - 1;
        updateLightboxImage();
    }

    function updateLightboxImage() {
        const img = document.getElementById('lightbox-img');
        img.style.opacity = '0.5';
        img.style.transform = 'translateX(0)';
        setTimeout(() => {
             img.src = galleryImages[currentImageIndex];
             img.style.opacity = '1';
        }, 150);
    }

    function closeLightbox() {
        document.getElementById('lightbox').style.display = 'none';
        document.body.style.overflow = 'auto';
    }

    const lightbox = document.getElementById('lightbox');
    lightbox.addEventListener('touchstart', e => { touchStartX = e.changedTouches[0].screenX; }, {passive: true});
    lightbox.addEventListener('touchend', e => { 
        touchEndX = e.changedTouches[0].screenX; 
        handleSwipe(); 
    }, {passive: true});

    function handleSwipe() {
        if (touchEndX < touchStartX - 50) changeImage(1);
        if (touchEndX > touchStartX + 50) changeImage(-1);
    }

    // --- REELS LOGIC ---
    let reelsLoaded = false;
    async function loadReels() {
        if (reelsLoaded) {
            // Just re-attach observer if needed
            if (!reelsObserver) initReelsObserver();
            return;
        }

        const username = 'mhoffman54';
        const repo = 'lindseyandmattadopt';
        const folder = 'reels'; // Make sure this folder exists in GitHub!
        const reelsContainer = document.getElementById('reels-container');
        const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/${folder}`;

        try {
            const response = await fetch(apiUrl);
            if (!response.ok) throw new Error('Reels Folder not found');
            const data = await response.json();
            
            document.getElementById('reels-loading').style.display = 'none';
            const videoFiles = data.filter(file => file.name.match(/\.(mp4|mov|webm)$/i));

            if (videoFiles.length === 0) {
                reelsContainer.innerHTML = '<p style="text-align:center; color:white; padding-top:50px;">No reels uploaded yet!</p>';
                return;
            }

            videoFiles.forEach((file) => {
                const div = document.createElement('div');
                div.className = 'reel-item';
                
                // Playsinline is crucial for mobile autoplay
                const video = document.createElement('video');
                video.src = file.download_url;
                video.controls = true; // Show controls so they can unmute/scrub
                video.playsInline = true; 
                video.loop = true;
                
                div.appendChild(video);
                reelsContainer.appendChild(div);
            });
            
            reelsLoaded = true;
            initReelsObserver();

        } catch (error) {
            console.error('Reels Error:', error);
            document.getElementById('reels-loading').innerText = 'Upload .mp4 files to a "reels" folder in GitHub!';
        }
    }

    function initReelsObserver() {
        if (reelsObserver) reelsObserver.disconnect();

        const options = {
            root: document.getElementById('reels-container'), // Scope to the scroll container
            threshold: 0.6 // Video must be 60% visible to play
        };

        reelsObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                const video = entry.target.querySelector('video');
                if (entry.isIntersecting) {
                    // Try to play. Note: Browsers block unmuted autoplay. 
                    // If user hasn't interacted, this might fail unless muted.
                    video.play().catch(e => console.log("Autoplay blocked, waiting for user interaction"));
                } else {
                    video.pause();
                }
            });
        }, options);

        const reelItems = document.querySelectorAll('.reel-item');
        reelItems.forEach(item => reelsObserver.observe(item));
    }

    async function loadGallery() {
        const username = 'mhoffman54';
        const repo = 'lindseyandmattadopt';
        const folder = 'gallery';
        const galleryContainer = document.getElementById('magic-gallery');
        const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/${folder}`;

        try {
            const response = await fetch(apiUrl);
            if (!response.ok) throw new Error('Folder not found');
            const data = await response.json();
            
            document.getElementById('loading-text').style.display = 'none';
            const imageFiles = data.filter(file => file.name.match(/\.(jpg|jpeg|png|gif|webp)$/i));

            if (imageFiles.length === 0) {
                galleryContainer.innerHTML = '<p style="text-align:center;">No photos found yet!</p>';
                return;
            }

            galleryImages = imageFiles.map(file => file.download_url);

            imageFiles.forEach((file, index) => {
                const div = document.createElement('div');
                div.className = 'gallery-item';
                div.onclick = function() { openLightboxByIndex(index); };
                const img = document.createElement('img');
                img.src = file.download_url;
                img.loading = 'lazy';
                div.appendChild(img);
                galleryContainer.appendChild(div);
            });
            
            setTimeout(initScrollObserver, 500);

        } catch (error) {
            console.error('Gallery Error:', error);
            document.getElementById('loading-text').innerText = 'Upload photos to the "gallery" folder to see them here!';
        }
    }

    function initScrollObserver() {
        if (observer) observer.disconnect();

        const options = {
            root: null,
            rootMargin: '-45% 0px -45% 0px', 
            threshold: 0
        };

        observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('mobile-pop');
                } else {
                    entry.target.classList.remove('mobile-pop');
                }
            });
        }, options);

        const targets = document.querySelectorAll('.gallery-item, .feature-img-wrapper');
        targets.forEach(target => observer.observe(target));
    }

    document.addEventListener('DOMContentLoaded', () => {
        loadGallery();
        initScrollObserver();
        window.addEventListener('scroll', () => { if(!observer) initScrollObserver(); }, { once: true });
        
        // Close popup when clicking outside
        document.addEventListener('click', function(event) {
            const popup = document.getElementById('contact-popup');
            const button = document.querySelector('.floating-contact');
            if (!popup.contains(event.target) && !button.contains(event.target) && popup.style.display === 'block') {
                popup.style.display = 'none';
            }
        });
    });
</script>

</body>
</html>
